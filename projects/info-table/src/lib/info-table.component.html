<div class="info-table-wrap">
  <div class="info-table-title" *ngIf="nzTitle">
    <ng-container *nzStringTemplateOutlet="nzTitle">
      {{ nzTitle }}
    </ng-container>
  </div>
  <div>
    <ng-container *ngIf="isArray(nzConfig)">
      <ng-container *ngFor="let row of nzConfig">
        <div class="info-table-row">
          <ng-container *ngIf="isArray(row)">
            <ng-container *ngFor="let item of row">
              <div class="info-table-field">
                <div class="field-label" [style.width]="nzLabelWidth">
                  {{ item.label }}
                </div>
                <div class="field-value">
                  <ng-container
                    *ngTemplateOutlet="
                      fieldRef;
                      context: {
                        ref: nzTemplateRefs[item.ref] || item.ref,
                        text: getValue(nzData, item),
                        link: getLink(nzData, item),
                        item: item,
                        data: nzData
                      }
                    "
                  >
                  </ng-container>
                </div>
              </div>
            </ng-container>
          </ng-container>
        </div>
      </ng-container>
    </ng-container>
  </div>
</div>

<ng-template
  #fieldRef
  let-ref="ref"
  let-text="text"
  let-item="item"
  let-data="data"
  let-link="link"
>
  <ng-container
    *nzStringTemplateOutlet="
      ref;
      context: {
        data: data,
        text: text,
        key: item.key,
        link: link
      }
    "
  >
    <ng-container *ngIf="item.ellipsis === false; else elseRef">
      <ng-container *ngTemplateOutlet="textRef"></ng-container>
    </ng-container>
    <ng-template #elseRef>
      <lib-ellipsis-text>
        <ng-container *ngTemplateOutlet="textRef"></ng-container>
      </lib-ellipsis-text>
    </ng-template>

    <ng-template #textRef>
      <a *ngIf="link" [href]="link" target="_blank">{{ text }}</a>
      <ng-container *ngIf="!link">{{ text }}</ng-container>
    </ng-template>
  </ng-container>
</ng-template>
