<div>
  <i
    nz-icon
    nzType="setting"
    class="setting-icon"
    nz-popover
    [nzPopoverTitle]="header"
    [nzPopoverContent]="content"
    nzPopoverTrigger="click"
    [nzPopoverOverlayClassName]="'table-setting-popover'"
    nzPopoverPlacement="bottomRight"
  ></i>
</div>

<ng-template #header>
  <div class="setting-header">
    <span>列展示</span>
    <button
      nz-button
      nzType="link"
      nzSize="small"
      [style.padding]="'0px'"
      (click)="onReset()"
    >
      重置
    </button>
  </div>
</ng-template>

<ng-template #content>
  <div class="content" cdkDropListGroup>
    <ng-container
      *ngTemplateOutlet="
        dropList;
        context: {
          title: '固定在左侧',
          list: fixedLeftList,
          key: 'fixedLeftList'
        }
      "
    ></ng-container>
    <ng-container
      *ngTemplateOutlet="
        dropList;
        context: { title: '不固定', list: centerList, key: 'centerList' }
      "
    ></ng-container>
    <ng-container
      *ngTemplateOutlet="
        dropList;
        context: {
          title: '固定在右侧',
          list: fixedRightList,
          key: 'fixedRightList'
        }
      "
    ></ng-container>
  </div>
</ng-template>

<ng-template #dropList let-title="title" let-type="title" let-list="list">
  <div>
    <div class="title">{{ title }}</div>
    <div
      class="drag-list"
      cdkDropList
      [cdkDropListData]="list"
      (cdkDropListDropped)="drop($event)"
    >
      <div
        *ngFor="let item of list"
        cdkDrag
        class="drag-list-item"
        [cdkDragDisabled]="!item.show"
      >
        <div class="item-custom-placeholder" *cdkDragPlaceholder></div>
        <div>
          <label nz-checkbox [(ngModel)]="item.show" class="label">
            {{ item.title }}
          </label>
        </div>
        <div *ngIf="item.show">
          <i
            class="action-icon"
            nz-icon
            nzType="vertical-align-top"
            nzTheme="outline"
            nz-tooltip
            nzTooltipTitle="固定在列首"
            nzTooltipPlacement="top"
          ></i>
          <i
            class="action-icon"
            nz-icon
            nzType="vertical-align-bottom"
            nzTheme="outline"
            nz-tooltip
            nzTooltipTitle="固定在列尾"
            nzTooltipPlacement="top"
          ></i>
        </div>
      </div>
    </div>
  </div>
</ng-template>
